# TodoPro: Task Management Application

**TodoPro** is a modern, full-stack task management application designed to help users stay organized and productive. It features a seamless user interface powered by a Next.js frontend and a secure, scalable FastAPI (Python) backend with Google OAuth2 authentication and PostgreSQL for data persistence. The application supports task creation, management, and tracking with advanced features like calendar views, priority levels, categories, and user profile management.

---

## ✨ Features

- **User Authentication**: Secure sign-in and sign-up using Google OAuth2 with JWT-based session management.
- **Dashboard**: A clean, filterable overview of all tasks, organized by status, priority, or category.
- **Task Management**: Full CRUD operations for todos, including titles, descriptions, due dates, priorities, and categories.
- **Calendar View**: Visualize tasks on an interactive calendar to plan and track deadlines.
- **Filtering & Sorting**: Advanced filtering by status, priority, or text search, with sorting by date or priority.
- **User Profile**: View and update profile details, including name, bio, and avatar.
- **Responsive Design**: A fluid, adaptive UI that works seamlessly across devices.
- **Toast Notifications**: User-friendly feedback for actions and errors using shadcn/ui toasts.
- **Secure Backend**: JWT access/refresh token rotation, secure cookie management, and avatar file handling.

---

## 🧱 Tech Stack

### Frontend
- **Next.js 14+**: React framework with App Router for performant web applications.
- **React**: JavaScript library for building user interfaces.
- **JavaScript**: Primary language for frontend logic.
- **Tailwind CSS**: Utility-first CSS framework for rapid UI development.
- **shadcn/ui**: Reusable UI components built with Radix UI and Tailwind CSS.
- **Lucide React**: Customizable open-source icons.
- **Axios**: Promise-based HTTP client for API requests.
- **Server Actions**: Next.js feature for server-side data mutations.

### Backend
- **FastAPI (Python)**: High-performance web framework for building APIs.
- **SQLAlchemy + Alembic**: ORM and migrations for PostgreSQL.
- **PostgreSQL**: Relational database for robust data storage.
- **Google OAuth 2.0 + JWT (python-jose)**: Secure authentication and session management.
- **httpx**: HTTP client utilities.
- **Avatar handling**: Local file storage served from `/static/avatars`.

---

## 📂 Project Structure

### Frontend
```
frontend/
├── src/
│   ├── app/                                 # Next.js App Router pages (route handlers)
│   │   ├── layout.jsx                       # Root layout for the entire application
│   │   ├── page.jsx                         # Root page (wrapper for modules/home/page.jsx - assuming a home page)
│   │   ├── globals.css                      # Global CSS styles
│   │   ├── login/
│   │   │   └── page.jsx                     # This will be a simple wrapper importing from modules/login/page.jsx
│   │   ├── calendar/
│   │   │   └── page.jsx                     # Wrapper for modules/calendar/page.jsx
│   │   ├── contact/
│   │   │   └── page.jsx                     # Wrapper for modules/contact/page.jsx
│   │   ├── dashboard/
│   │   │   └── page.jsx                     # Wrapper for modules/dashboard/page.jsx
│   │   ├── features/
│   │   │   └── page.jsx                     # Wrapper for modules/features/page.jsx
│   │   ├── help/
│   │   │   └── page.jsx                     # Wrapper for modules/help/page.jsx
│   │   ├── privacy/
│   │   │   └── page.jsx                     # Wrapper for modules/privacy/page.jsx
│   │   ├── profile/
│   │   │   ├── edit/
│   │   │   │   └── page.jsx                 # Wrapper for modules/profile/edit/page.jsx
│   │   │   └── page.jsx                     # Wrapper for modules/profile/page.jsx
│   │   └── terms/
│   │       └── page.jsx                     # Wrapper for modules/terms/page.jsx
│   │
│   ├── components/                          # Reusable UI components (e.g., Shadcn UI, shared UI elements)
│   │   ├── shared/                          # Components used across many parts of the app (Header, Footer)
│   │   │   ├── footer.jsx
│   │   │   └── header.jsx
│   │   ├── todo/                            # Components specific to the "todo" feature/domain
│   │   │   ├── todo-card.jsx
│   │   │   ├── todo-filters.jsx
│   │   │   └── todo-form.jsx
│   │   └── ui/                              # Shadcn UI components (generated by `shadcn-ui add`)
│   │       ├── accordion.tsx
│   │       ├── alert.tsx
│   │       ├── avatar.tsx
│   │       ├── badge.tsx
│   │       ├── button.tsx
│   │       ├── card.tsx
│   │       ├── checkbox.tsx
│   │       ├── dialog.tsx
│   │       ├── dropdown-menu.tsx
│   │       ├── input.tsx
│   │       ├── label.tsx
│   │       ├── select.tsx
│   │       ├── sonner.tsx
│   │       └── textarea.tsx
│   │
│   ├── lib/                                 # Pure, framework-agnostic utilities (no React, no API calls)
│   │   ├── constants.ts                     # Application-wide constants (e.g., categories, priorities)
│   │   └── utils.ts                         # General utility functions (e.g., `cn` for Tailwind)
│   │
│   ├── services/                            # Interfacing with external APIs & core business logic
│   │   ├── actions/                         # Next.js Server Actions (backend-like operations)
│   │   │   ├── todo.actions.ts              # Server actions related to todos (create, update, delete)
│   │   │   └── user.actions.ts              # Server actions related to users (update profile)
│   │   ├── api/
│   │   │   └── axiosInstance.ts             # Centralized Axios setup with interceptors for API calls
│   │   ├── auth/
│   │   │   └── auth.service.ts              # Client-side authentication logic (sign-in, current user, token management)
│   │   └── todos/
│   │       └── todos.service.ts             # Client-side data fetching and filtering logic for todos
│   │
│   └── modules/                             # Feature modules: encapsulated logic & views per route
│       ├── login/
│       │   ├── index.jsx
│       │   └── view.jsx
│       ├── calendar/
│       │   ├── index.jsx
│       │   └── view.jsx
│       ├── contact/
│       │   ├── index.jsx
│       │   └── view.jsx
│       ├── dashboard/
│       │   ├── index.jsx
│       │   └── view.jsx
│       ├── features/
│       │   ├── index.jsx
│       │   └── view.jsx
│       ├── help/
│       │   ├── index.jsx
│       │   └── view.jsx
│       ├── home/
│       │   ├── index.jsx
│       │   └── view.jsx
│       ├── privacy/
│       │   ├── index.jsx
│       │   └── view.jsx
│       ├── profile/
│       │   ├── index.jsx
│       │   └── view.jsx
│       │   └── edit/
│       │       ├── index.jsx
│       │       └── view.jsx
│       └── terms/
│           ├── index.jsx
│           └── view.jsx
│
├── .env.local                               # Environment Variables file
├── components.json                          # Shadcn UI configuration file
├── eslint.config.mjs                        # ESLint configuration
├── next-env.d.ts                            # Next.js environment type definitions
├── next.config.ts                           # Next.js configuration
├── node_modules/                            # Node.js dependencies
├── package.json                             # Project metadata and dependencies
├── package-lock.json                        # Exact dependency tree
├── postcss.config.mjs                       # PostCSS configuration for Tailwind CSS
├── README.md                                # Project README file
├── tailwind.config.js                       # Tailwind CSS configuration
└── tsconfig.json                            # TypeScript configuration
```

### Backend

```text
python-backend/                                   # Backend repository root
│
├── app/                                          # Main application code
│   ├── __init__.py                               # Marks `app` as a package
│   ├── main.py                                   # FastAPI app entrypoint (routers, static, CORS, handlers)
│   │
│   ├── core/                                     # App-wide core (settings, security, guards, errors)
│   │   ├── __init__.py                           # Marks `core` as a package
│   │   ├── api_key_guard.py                      # X-API-Key guard
│   │   ├── config.py                             # Pydantic settings (reads env)
│   │   ├── exceptions.py                         # Exception handlers
│   │   ├── oauth.py                              # Google OAuth client helpers
│   │   ├── refresh_token_guard.py                # Refresh token validation dependency
│   │   └── security.py                           # JWT utilities & get_current_user
│   │
│   ├── utils/                                    # Helpers
│   │   ├── __init__.py                           # Marks `utils` as a package
│   │   ├── helpers.py                            # parse_timedelta, ensure_static_dirs, file helpers
│   │   └── validators.py                         # Input/file validators
│   │
│   ├── db/                                       # Database setup & models
│   │   ├── __init__.py                           # Marks `db` as a package
│   │   ├── base.py                               # SQLAlchemy declarative Base/metadata
│   │   ├── dependencies.py                       # DB helpers
│   │   ├── session.py                            # Async engine/session & get_db
│   │   ├── sync_session.py                       # Sync session (Alembic / utilities)
│   │   ├── models/
│   │   │   ├── __init__.py                       # Consolidates model exports
│   │   │   ├── todo.py                           # SQLAlchemy ORM model: Todo
│   │   │   └── user.py                           # SQLAlchemy ORM model: User
│   │   └── migrations/
│   │       ├── __init__.py                       # Marks Alembic migrations as a package
│   │       ├── env.py                            # Alembic env bound to SQLAlchemy metadata
│   │       ├── script.py.mako
│   │       └── versions/
│   │
│   ├── api/                                      # Feature modules
│   │   ├── __init__.py                           # Marks `api` as a package
│   │   ├── auth/                                 # Authentication
│   │   │   ├── __init__.py                       # Marks `auth` as a package
│   │   │   ├── repository.py                     # Data access layer for auth
│   │   │   ├── router.py                         # /auth routes
│   │   │   ├── schemas.py                        # Pydantic models for requests/responses
│   │   │   └── service.py                        # Google sign-in, refresh, logout business logic
│   │   ├── users/                                # User management
│   │   │   ├── __init__.py                       # Marks `users` as a package
│   │   │   ├── repository.py                     # Data access layer for users
│   │   │   ├── router.py                         # /user routes
│   │   │   ├── schemas.py                        # Pydantic models for requests/responses
│   │   │   └── service.py                        # Profile get/update + avatar handling
│   │   └── todos/                                # Todo management
│   │       ├── __init__.py                       # Marks `todos` as a package
│   │       ├── repository.py                     # Data access layer for todos
│   │       ├── router.py                         # /todos routes
│   │       ├── schemas.py                        # Pydantic models for requests/responses
│   │       └── service.py                        # Todo business logic
│   │
│   └── services/                                 # Extra services
│       ├── __init__.py                           # Marks `services` as a package
│       └── file_service.py                       # File save/delete helpers for avatars
│
├── static/                                       # Publicly served static files
│   └── avatars/                                  # Stored profile pictures; served under `/static/avatars`
│
├── requirements.txt                              # Python dependencies
├── alembic.ini                                   # Alembic configuration
├── README.md                                     # Project Documentation
├── .env.example                                  # Example environment variables
├── .env                                          # Local environment variables
└── .gitignore                                    # Git ignore rules
```

---

## ⚙️ Setup Instructions

### Prerequisites
- **Node.js**: v18.x or later ([nodejs.org](https://nodejs.org/en/download/)).
  - Verify with: `node -v` and `npm -v`.
- **npm or Yarn**: Package manager for dependency installation.
- **PostgreSQL**: Database for storing user and todo data.
- **Google OAuth Credentials**: Obtain `GOOGLE_CLIENT_ID` and `GOOGLE_CLIENT_SECRET` from [Google Cloud Console](https://console.cloud.google.com/).
- **Python 3.10+ installed**:
  - macOS (Homebrew): `brew install python`
  - Linux (Debian/Ubuntu): `sudo apt update && sudo apt install -y python3 python3-venv python3-pip`
  - Windows (winget): `winget install Python.Python.3.12`
  - Or download from https://www.python.org/downloads/

### Frontend Setup
1. **Clone the Repository**:
   ```bash
   git clone https://github.com/hodev09/todo-app.git
   cd todo-app/frontend
   ```

2. **Install Dependencies**:
   ```bash
   npm install
   ```
   Or with Yarn:
   ```bash
   yarn install
   ```

3. **Configure Environment Variables**:
   Create a `.env.local` file in the `frontend/` directory:
   ```env
   NEXT_PUBLIC_API_BASE_URL="http://localhost:8000"
   NEXT_PUBLIC_AUTH_API_URL="http://localhost:8000"
   NEXT_PUBLIC_API_KEY="your_api_secret_key"
   ```

   * `NEXT_PUBLIC_API_BASE_URL`: Base URL of your main backend API endpoints
   * `NEXT_PUBLIC_AUTH_API_URL`: Base URL for authentication endpoints (can be same as above)
   * `NEXT_PUBLIC_API_KEY`: Secret key for protecting the endpoints
   ---

4. **Run the Application**:
   ```bash
   npm run dev
   ```
   Or with Yarn:
   ```bash
   yarn dev
   ```
   Open [http://localhost:3000](http://localhost:3000) in your browser.

### Backend Setup
1. **Navigate to Python Backend Directory**:
   ```bash
   cd python-backend
   ```

2. **Create and Activate Virtual Environment**:
   macOS/Linux
   ```bash
   python -m venv venv
   source venv/bin/activate
   ```
   Windows (PowerShell)
   ```powershell
   py -3 -m venv venv
   .\venv\Scripts\Activate.ps1
   ```

3. **Install Dependencies**:
   ```bash
   pip install -r requirements.txt
   ```

4. **Create `.env` File**:
   ```env
   ENVIRONMENT=development
   DATABASE_URL=postgresql+asyncpg://DATABASE_USERNAME:DATABASE_PASSWORD@DATABASE_HOSTNAME:DATABASE_PORT/DATABASE_NAME
   DATABASE_SYNC_URL=postgresql://DATABASE_USERNAME:DATABASE_PASSWORD@DATABASE_HOSTNAME:DATABASE_PORT/DATABASE_NAME
   ACCESS_TOKEN_SECRET=your_access_token_secret
   REFRESH_TOKEN_SECRET=your_refresh_token_secret
   API_KEY=your_api_key
   ALGORITHM=HS256
   ACCESS_TOKEN_EXPIRE=30m
   REFRESH_TOKEN_EXPIRE=7d
   GOOGLE_CLIENT_ID=your-google-client-id
   GOOGLE_CLIENT_SECRET=your-google-client-secret
   GOOGLE_REDIRECT_URI=http://localhost:8000/auth/google/callback
   MAX_FILE_SIZE=2097152
   UPLOAD_DIR=static/avatars
   ALLOWED_EXTENSIONS=jpg,jpeg,png,gif,svg
   ```

5. **Run Database Migrations (Alembic)**:
   ```bash
   alembic upgrade head
   ```

6. **Start the Server (Uvicorn)**:
   ```bash
   uvicorn app.main:app --reload
   ```

---

## 🔐 APIs

### Authentication
| Method | Endpoint                          | Description |
| ------ | --------------------------------- | ----------- |
| GET    | `/auth/google`                    | Redirects to Google login |
| GET    | `/auth/google/callback?code=...`  | Handles OAuth2 callback |
| POST   | `/auth/refresh`                   | Returns a fresh access token (requires refresh cookie) |
| POST   | `/auth/logout`                    | Logs out user and clears refresh cookie |

Behavior on successful callback:
- Sets `refresh_token` as HttpOnly cookie (SameSite=Lax; use Secure in production).
- Redirects to frontend with `access_token` in the URL query.

Example refresh response:
```json
{ "access_token": "<jwt>", "token_type": "bearer" }
```

Example logout response:
```json
{ "message": "Logged out successfully" }
```

### User Profile
| Method | Endpoint   | Description                 |
| ------ | ---------- | --------------------------- |
| GET    | `/user/me` | Get logged-in user profile  |
| PATCH  | `/user/me` | Update name, bio, or avatar (requires `Authorization` and `X-API-Key`) |

**Get Profile Response** (avatar is an absolute URL):
```json
{
  "id": "uuid",
  "email": "user@example.com",
  "name": "User Name",
  "avatar": "http://localhost:8000/static/avatars/avatar.jpg",
  "bio": "string | null",
  "createdAt": "2025-07-17T10:00:00.000Z"
}
```

### Todos
| Method | Endpoint     | Description         |
| ------ | ------------ | ------------------- |
| POST   | `/todos`     | Create a new todo   |
| GET    | `/todos`     | Get all user todos (supports filters) |
| GET    | `/todos/:id` | Get a single todo   |
| PATCH  | `/todos/:id` | Update a todo       |
| DELETE | `/todos/:id` | Delete a todo       |

**Create Todo Request**:
```json
{
  "title": "Buy groceries",
  "description": "Milk, Eggs, Bread",
  "priority": "high",
  "category": "personal",
  "dueDate": "2025-07-30T10:00:00.000Z"
}
```

**Create Todo Response**:
```json
{
  "id": "uuid",
  "title": "Buy groceries",
  "description": "Milk, Eggs, Bread",
  "priority": "high",
  "category": "personal",
  "dueDate": "2025-07-30T10:00:00.000Z",
  "completed": false,
  "createdAt": "2025-07-17T11:00:00.000Z",
  "updatedAt": "2025-07-17T11:00:00.000Z"
}
```

---

## 🛡️ Security Best Practices
- **Frontend**:
  - Client-side token management with automatic refresh on 401 errors.
  - Secure Axios interceptors for attaching tokens to requests.
  - Next.js Server Actions for secure data mutations.
- **Backend (FastAPI)**:
  - Access token in `Authorization: Bearer <token>` header.
  - Refresh token set as HttpOnly cookie (SameSite=Lax; use `Secure` in production).
  - API key header (`X-API-Key`) required for sensitive routes like `PATCH /user/me`.
  - File validation: allowed extensions and max size enforced; avatars served from `/static/avatars`.
  - Robust environment validation via Pydantic settings.

---

## 🙋 Contributions
- Fork the repository and submit pull requests.
- Report issues or suggest improvements via GitHub Issues.
- Contact the team via email for collaboration.

---

## 📄 License
This project is licensed under the **MIT License** © 2025.
